# Use an x86_64 base image for compatibility with HISAT2 binaries
FROM --platform=linux/amd64 ubuntu:20.04

# Set environment variables
ENV DEBIAN_FRONTEND=noninteractive

# Install necessary packages and tools
RUN apt-get update && \
    apt-get install -y \
    wget \
    unzip \
    build-essential \
    zlib1g-dev \
    liblzma-dev \
    python3 \
    ca-certificates \
    && apt-get clean

# Download HISAT2 for Linux (x86_64)
RUN wget https://cloud.biohpc.swmed.edu/index.php/s/oTtGWbWjaxsQ2Ho/download -O hisat2-linux-x86_64.zip && \
    unzip hisat2-linux-x86_64.zip -d /opt && \
    mv /opt/hisat2-*/ /usr/local/hisat2/ && \
    ln -s /usr/local/hisat2/hisat2* /usr/local/bin/ && \
    chmod +x /usr/local/bin/hisat2*

# Add HISAT2 to PATH
ENV PATH="/usr/local/bin:${PATH}"

# Set the working directory
WORKDIR /data

# Default command
CMD ["hisat2", "--help"]
